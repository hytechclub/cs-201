
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Part 7 - Multiple Enemies Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-toggle-chapters/toggle.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Part8LifeScore.html" />
    
    
    <link rel="prev" href="Part6Collisions.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../EnvironmentSetup.html">
            
                <a href="../EnvironmentSetup.html">
            
                    
                    Environment Setup
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../MacSetup.html">
            
                <a href="../MacSetup.html">
            
                    
                    Mac Setup
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="StudentDesc.html">
            
                <a href="StudentDesc.html">
            
                    
                    Walkthroughs
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="Part0HelloWorld.html">
            
                <a href="Part0HelloWorld.html">
            
                    
                    Part 0 - Hello World
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="Part1PlayerClass.html">
            
                <a href="Part1PlayerClass.html">
            
                    
                    Part 1 - The Player Class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="Part2EnemyClass.html">
            
                <a href="Part2EnemyClass.html">
            
                    
                    Part 2 - The Enemy Class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="Part3SpriteClass.html">
            
                <a href="Part3SpriteClass.html">
            
                    
                    Part 3 - The Sprite Class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="Part4PlayerProjectiles.html">
            
                <a href="Part4PlayerProjectiles.html">
            
                    
                    Part 4 - Player Projectiles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="Part5EnemyProjectiles.html">
            
                <a href="Part5EnemyProjectiles.html">
            
                    
                    Part 5 - Enemy Projectiles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="Part6Collisions.html">
            
                <a href="Part6Collisions.html">
            
                    
                    Part 6 - Collisions
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.8" data-path="Part7MultipleEnemies.html">
            
                <a href="Part7MultipleEnemies.html">
            
                    
                    Part 7 - Multiple Enemies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="Part8LifeScore.html">
            
                <a href="Part8LifeScore.html">
            
                    
                    Part 8 - Life & Score
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="Part9GameOver.html">
            
                <a href="Part9GameOver.html">
            
                    
                    Part 9 - Game Over
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../Reference.html">
            
                <a href="../Reference.html">
            
                    
                    Reference
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../SessionRecordings.html">
            
                <a href="../SessionRecordings.html">
            
                    
                    Session Recordings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../EnhancementIdeas.html">
            
                <a href="../EnhancementIdeas.html">
            
                    
                    Enhancement Ideas
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Part 7 - Multiple Enemies</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="part-7---multiple-enemies">Part 7 - Multiple Enemies</h1>
<p>In this walkthrough, update the game so that there are multiple enemies, and they can all be destroyed. All changes for this part will take place in the <strong>ArcadeFlyerGame.cs</strong> file.</p>
<h2 id="a-list-of-enemy-objects">A <code>List</code> of <code>Enemy</code> Objects</h2>
<p>The first thing to do is make sure the <code>ArcadeFlyerGame</code> class is able to handle multiple enemies. Currently, there is one <code>Enemy</code> field that creates the single enemy in the game. Update it so it uses a <code>List&lt;Enemy&gt;</code> field instead. Note that this is an example of <em>refactoring;</em> the game should function the same, but it will be much easier to maintain and update!</p>
<h3 id="creating-the-list">Creating the List</h3>
<p>Make the changes in the <strong>ArcadeFlyerGame.cs</strong> file.</p>
<ol>
<li>Find the <code>private Enemy enemy</code> field and remove it</li>
<li>Instead, add a <code>private List&lt;Enemy&gt;</code> field to the <code>ArcadeFlyerGame</code> class named <code>enemies</code>  <pre><code class="lang-cs"> <span class="hljs-keyword">private</span> List&lt;Enemy&gt; enemies;
</code></pre>
</li>
<li>In the <code>ArcadeFlyerGame()</code> constructor, find where the <code>enemy</code> field was set</li>
<li>Instead of doing this, initialize the <code>enemies</code> field to a new empty list of type <code>Enemy</code>  <pre><code class="lang-cs"> enemies = <span class="hljs-keyword">new</span> List&lt;Enemy&gt;();
</code></pre>
</li>
<li>On the next line, add the original <code>new Enemy</code> object from before to the <code>enemies</code> list  <pre><code class="lang-cs"> enemies.Add(<span class="hljs-keyword">new</span> Enemy(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">new</span> Vector2(screenWidth, <span class="hljs-number">0</span>)));
</code></pre>
</li>
</ol>
<h3 id="fixing-the-update-and-draw-methods">Fixing the <code>Update</code> and <code>Draw</code> Methods</h3>
<p>At this point, there should be some errors in the <strong>ArcadeFlyerGame.cs</strong> file. This is because the class still references the <code>enemy</code> field. Fix the errors in the <code>Update</code> and <code>Draw</code> methods so that they properly handle the <code>enemies</code> field instead.</p>
<ol>
<li>In the <code>Update</code> method, find the <code>enemy.Update(gameTime)</code> method call</li>
<li>Remove that code, and instead create a <code>foreach</code> loop</li>
<li>Set the loop to iterate through each <code>Enemy</code> object in the <code>enemies</code> list</li>
<li>In the body of the <code>foreach</code> loop, call <code>Update</code> on the current enemy object<pre><code class="lang-cs"> <span class="hljs-keyword">foreach</span> (Enemy enemy <span class="hljs-keyword">in</span> enemies)
 {
     enemy.Update(gameTime);
 }
</code></pre>
</li>
<li>In the <code>Draw</code> method, find the <code>enemy.Draw(gameTime, spriteBatch)</code> method call</li>
<li>Remove that code, and instead create a <code>foreach</code> loop</li>
<li>Set the loop to iterate through each <code>Enemy</code> object in the <code>enemies</code> list</li>
<li>In the body of the <code>foreach</code> loop, call <code>Draw</code> on the current enemy object<pre><code class="lang-cs"> <span class="hljs-keyword">foreach</span> (Enemy enemy <span class="hljs-keyword">in</span> enemies)
 {
     enemy.Update(gameTime, spriteBatch);
 }
</code></pre>
</li>
</ol>
<h3 id="fixing-the-collision-detection">Fixing the Collision Detection</h3>
<p>Previously, the game only needed to detect collisions for one enemy. Now, since there are multiple enemies, the code will have to handle collisions for all of them.</p>
<ol>
<li>In the <code>Update</code> method, find the collision detection for enemies  <pre><code class="lang-cs"> <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> (<span class="hljs-params">playerProjectile &amp;&amp; getCollision(enemy.PositionRectangle, p.PositionRectangle</span>)) </span>{ <span class="hljs-comment">// ...</span>
</code></pre>
</li>
<li>Cut the <code>&amp;&amp;</code> and everything after it, so that the <code>else if</code> only checks for <code>playerProjectile</code>  <pre><code class="lang-cs"> <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> (<span class="hljs-params">playerProjectile</span>) </span>{ <span class="hljs-comment">// ...</span>
</code></pre>
</li>
<li>In the body of the <code>else if</code>, create a <code>foreach</code> loop to loop through each enemy  <pre><code class="lang-cs"> <span class="hljs-keyword">foreach</span> (Enemy enemy <span class="hljs-keyword">in</span> enemies) { }
</code></pre>
</li>
<li>In the body of the <code>foreach</code> loop, create an <code>if</code> statement checking if there is a collision between the current projectile and the current enemy  <ul>
<li>Note that this is the same condition that was cut from above</li>
</ul>
</li>
<li>In the body of the <code>if</code> statement, remove the current projectile <code>p</code> from the <code>projectiles</code> list  <pre><code class="lang-cs"> projectiles.Remove(p);
</code></pre>
</li>
</ol>
<h4 id="code">Code</h4>
<pre><code class="lang-cs"><span class="hljs-keyword">if</span> (!playerProjectile &amp;&amp; getCollision(player.PositionRectangle, p.PositionRectangle))
{
    projectiles.Remove(p);
}
<span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> (<span class="hljs-params">playerProjectile</span>))
</span>{
    <span class="hljs-keyword">foreach</span> (Enemy enemy <span class="hljs-keyword">in</span> enemies)
    {
        <span class="hljs-keyword">if</span> (getCollision(enemy.PositionRectangle, p.PositionRectangle))
        {
            projectiles.Remove(p);
        }
    }
}
</code></pre>
<p>At this point, it should be possible to run the game again! It should function exactly the same as it did before, but now it will be possible to create multiple enemies.</p>
<h2 id="enemy-destruction">Enemy Destruction</h2>
<p>The next step is to destroy an enemy if a player projectile collides with it. Using the <code>List&lt;Enemy&gt;</code>, this is as simple as removing the given enemy from the list.</p>
<ol>
<li>In the <code>Update</code> method, find where it loops through the <code>enemies</code> list</li>
<li>Update the <code>foreach</code> loop, and make it a <code>for</code> loop instead</li>
<li>Make the <code>for</code> loop loop through the <code>enemies</code> list in <em>reverse</em> order  <pre><code class="lang-cs"> <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> enemyIdx = enemies.Count - <span class="hljs-number">1</span>; enemyIdx &gt;= <span class="hljs-number">0</span>; enemyIdx--) { }
</code></pre>
</li>
<li>In the body of the <code>for</code> loop, create an <code>Enemy enemy</code> variable and set it to the enemy at the current index  <pre><code class="lang-cs"> Enemy enemy = enemies[enemyIdx];
</code></pre>
</li>
<li>Now, within the body of the <code>if</code> that checks for collisions, under where it removes the projectile, remove the current enemy from the list  <pre><code class="lang-cs"> enemies.Remove(enemy);
</code></pre>
</li>
</ol>
<h4 id="code">Code</h4>
<pre><code class="lang-cs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> enemyIdx = enemies.Count - <span class="hljs-number">1</span>; enemyIdx &gt;= <span class="hljs-number">0</span>; enemyIdx--)
{
    Enemy enemy = enemies[enemyIdx];

    <span class="hljs-keyword">if</span> (getCollision(enemy.PositionRectangle, p.PositionRectangle))
    {
        projectiles.Remove(p);
        enemies.Remove(enemy);
    }
}
</code></pre>
<p>Run the game again. At this point, the enemy should disappear when a projectile collides with it! But having only one enemy is not very fun...</p>
<h2 id="enemy-creation">Enemy Creation</h2>
<p>Finally, use a <code>Timer</code> to add new <code>Enemy</code> objects to the <code>enemies</code> list on a regular basis. The goal will be to have a new enemy appear every three seconds.</p>
<h3 id="creating-and-initializing-the-enemycreationtimer-field">Creating and Initializing the <code>enemyCreationTimer</code> Field</h3>
<p>Create a new <code>Timer</code> field, and start the timer.</p>
<ol>
<li>Under the <code>private List&lt;Enemy&gt; enemies</code> field, create a <code>private Timer</code> field named <code>enemyCreationTimer</code>  <pre><code class="lang-cs"> <span class="hljs-keyword">private</span> Timer enemyCreationTimer;
</code></pre>
</li>
<li>In the <code>ArcadeFlyerGame()</code> constructor, set the <code>enemyCreationTimer</code> to a new <code>3.0</code>-second timer  <pre><code class="lang-cs"> enemyCreationTimer = <span class="hljs-keyword">new</span> Timer(<span class="hljs-number">3.0</span>f);
</code></pre>
</li>
<li>Call the <code>StartTimer</code> method on the newly-created <code>enemyCreationTimer</code>  <pre><code class="lang-cs"> enemyCreationTimer.StartTimer();
</code></pre>
</li>
</ol>
<h3 id="adding-new-enemies">Adding New Enemies</h3>
<p>Now it&apos;s time to add some new enemies! A new enemy should be added every time the <code>enemyCreationTimer</code> goes off (i.e. any time the <code>enemyCreationTimer.Active</code> value is false).</p>
<ol>
<li>Find the <code>Update</code> method, and make some new lines at the bottom</li>
<li>Create an <code>if</code> statement checking <code>!enemyCreationTimer.Active</code>  <pre><code class="lang-cs"> <span class="hljs-keyword">if</span> (!enemyCreationTimer.Active) { }
</code></pre>
</li>
<li>In the body of the <code>if</code> statement, create a new <code>Enemy</code> and add it to the <code>enemies</code> list  <ul>
<li>Note that this is just like what happens when the first enemy is created in the constructor!</li>
</ul>
</li>
<li>Under that, still within the <code>if</code> body, start the timer again  <pre><code class="lang-cs"> enemyCreationTimer.StartTimer();
</code></pre>
</li>
<li>Under the <code>if</code> statement, call the <code>Update</code> method on the <code>enemyCreationTimer</code>  <pre><code class="lang-cs"> enemyCreationTimer.Update(gameTimer);
</code></pre>
</li>
</ol>
<h4 id="code">Code</h4>
<pre><code class="lang-cs"><span class="hljs-keyword">if</span> (!enemyCreationTimer.Active)
{
    enemies.Add(<span class="hljs-keyword">new</span> Enemy(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">new</span> Vector2(screenWidth, <span class="hljs-number">0.0</span>f)));
    enemyCreationTimer.StartTimer();
}

enemyCreationTimer.Update(gameTime);
</code></pre>
<p>Run the game. At this point, enemies should be destroyed <em>and</em> regenerate every three seconds! Feel free to update the timer values to change the rates of enemy creation and projectile firing.</p>
<h2 id="final-code">Final Code</h2>
<p>The final code for this walkthrough is available on <a href="https://github.com/hylandtechoutreach/ArcadeFlyer/tree/Part8Start" target="_blank">GitHub</a>.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Part6Collisions.html" class="navigation navigation-prev " aria-label="Previous page: Part 6 - Collisions">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Part8LifeScore.html" class="navigation navigation-next " aria-label="Next page: Part 8 - Life & Score">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Part 7 - Multiple Enemies","level":"1.3.8","depth":2,"next":{"title":"Part 8 - Life & Score","level":"1.3.9","depth":2,"path":"Walkthroughs/Part8LifeScore.md","ref":"Walkthroughs/Part8LifeScore.md","articles":[]},"previous":{"title":"Part 6 - Collisions","level":"1.3.7","depth":2,"path":"Walkthroughs/Part6Collisions.md","ref":"Walkthroughs/Part6Collisions.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["toggle-chapters"],"pluginsConfig":{"toggle-chapters":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"BOOKREADME.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Walkthroughs/Part7MultipleEnemies.md","mtime":"2020-11-10T21:13:05.041Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-11-10T21:13:44.720Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-toggle-chapters/toggle.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

